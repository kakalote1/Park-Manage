(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e968370"],{2336:function(e,t,a){"use strict";a("9c4d")},"256c":function(module,__webpack_exports__,__webpack_require__){"use strict";var core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("4160"),core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_for_each__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("a434"),core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es_array_splice__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("b0c0"),core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es_function_name__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("a9e3"),core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es_number_constructor__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("159b"),core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_web_dom_collections_for_each__WEBPACK_IMPORTED_MODULE_4__),_api_workOrder__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("663e"),_api_upFile__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("72e0"),_api_userApi__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("37a2"),_api_dimension__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("21cd"),compressorjs__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("7c8d"),compressorjs__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(compressorjs__WEBPACK_IMPORTED_MODULE_9__);__webpack_exports__["a"]={components:{},filters:{},data:function(){return{form:{ID:this.getUUid(),SecunityCode:this.getUUid(),SecunityContent:"",SecunityType:3,SecunityStatus:1,SecunityBussId:"0",ChargeUserID:"",ChargeUserName:"",ChargeDeptMent:"123",ChargeDuty:"部长",ChargeLinkPhone:"123",CahrgeContent:"",OperatorUserId:JSON.parse(localStorage.getItem("userInfo")).uid,OperatorUserName:JSON.parse(localStorage.getItem("userInfo")).real_name,OperationTime:new Date,OperatorLinkOhone:JSON.parse(localStorage.getItem("userInfo")).mobile,Creater:JSON.parse(localStorage.getItem("userInfo")).real_name,CreateTime:new Date,Validity:1,LinkPicture:"",OrderNo:"",OrderMoney:"",OrderGoods:"",LogisticsCompany:""},pictureList:[],orderType:"保洁工单",typeList:[],showPicker:!1,isStore:!1,peoples:[],peopleobj:{},showPicker2:!1,upImgList:[],parentList:[]}},computed:{},watch:{},created:function(){console.log(JSON.parse(localStorage.getItem("userInfo")).mobile)},mounted:function(){this.getTypeInfos(),this.getParentList(),this.$toast.loading({message:"正在加载",forbidClick:!0,duration:500})},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){},methods:{getParentList:function(){var e=this;Object(_api_userApi__WEBPACK_IMPORTED_MODULE_7__["f"])().then((function(t){var a=t.data.tree[0].children;for(var o in a){var r=a[o].name,s=a[o].id;e.peoples.push({id:s,text:r})}var i=function(t){var o=a[t].id;Object(_api_userApi__WEBPACK_IMPORTED_MODULE_7__["g"])({id:o}).then((function(t){var a=[];for(var r in t.data.list){var s=t.data.list[r].real_name,i=t.data.list[r].uid,n={uid:i,text:s};a.push(n),e.peopleobj[s]=t.data.list[r]}for(var _ in e.peoples){var c=e.peoples[_].id;c===o&&(e.peoples[_].children=a)}}))};for(var n in a)i(n)}))},addWorkOrder:function(){var e=this;this.form.SecunityContent?this.form.ChargeUserName?this.$dialog.confirm({message:"确认新增"}).then((function(){e.pictureList.length&&(e.form.LinkPicture=e.pictureList[0].DownloadPath),Object(_api_workOrder__WEBPACK_IMPORTED_MODULE_5__["a"])(e.form).then((function(t){1===e.$route.query.modelType?e.$router.push({name:"MOOrderHead"}):2===e.$route.query.modelType?e.$router.push({name:"OMOrderHead"}):e.$router.push({name:"MOOrderHead"}),e.$store.commit("active",2)}))})).catch((function(){})):this.$toast({message:"请选择指派人",position:"top"}):this.$toast({message:"请输入工单内容",position:"top"})},handleCancel:function(){var e=this;this.$dialog.confirm({message:"是否放弃新增"}).then((function(){e.pictureList.forEach((function(e){var t=[e.FileID];Object(_api_upFile__WEBPACK_IMPORTED_MODULE_6__["a"])(t).then((function(e){console.log("图片删除返回",e)}))})),e.$router.go(-1)})).catch((function(){}))},getTypeInfos:function getTypeInfos(){var _this4=this,info={SysCode:"ProjectSecunityService",Key:"SecunityType"};Object(_api_dimension__WEBPACK_IMPORTED_MODULE_8__["a"])(info).then((function(response){var type=eval(response.Data.UValue);for(var index in type)"3"==type[index].ItemValue?_this4.typeList.splice(0,0,{text:type[index].Description,id:Number(type[index].ItemValue)}):"2"==type[index].ItemValue||_this4.typeList.push({text:type[index].Description,id:Number(type[index].ItemValue)})}))},getUUid:function(){for(var e=(new Date).valueOf(),t="",a=0;a<3;a++)t+=Math.floor(10*Math.random());return e+t},submit:function(){console.log("表单内容",this.form)},gdtype:function(e){this.form.SecunityType=e.id,this.orderType=e.text,this.showPicker=!1,6==this.form.SecunityType?this.isStore=!0:this.isStore=!1},upImgBefore:function(e){if(e.type){if("image/jpeg"!=e.type&&"image/png"!=e.type)return!1}else for(var t in e)if("image/jpeg"!=e[t].type&&"image/png"!=e[t].type)return!1;return!0},upImgAfter:function(e){console.log("图片上传后",e);var t=this;if(e instanceof Array)e.forEach((function(e){var a=e.file;new compressorjs__WEBPACK_IMPORTED_MODULE_9___default.a(a,{quality:.5,success:function(e){console.log("压缩成功",e),t.requestUpImg(e)},error:function(e){console.log(e.message)}})}));else{var a=e.file;new compressorjs__WEBPACK_IMPORTED_MODULE_9___default.a(a,{quality:.5,success:function(e){console.log("压缩成功",e),t.requestUpImg(e)},error:function(e){console.log(e.message)}})}},requestUpImg:function(e){var t=this;console.log("发送图片上传请求",e);var a={assocID:this.form.ID,module:this.form.SecunityType,submodule:"待处理",Uploader:this.form.OperatorUserName,file:e};a=this.objToFormData(a),Object(_api_upFile__WEBPACK_IMPORTED_MODULE_6__["c"])(a).then((function(e){t.pictureList.push({DownloadPath:e.Data[0].DownloadPath,FileID:e.Data[0].FileID})}))},objToFormData:function(e){var t=new FormData;for(var a in e)t.append(a,e[a]);return t},deleteImg:function(e,t){var a=this.pictureList.splice(t.index,1),o=[a[0].FileID];return Object(_api_upFile__WEBPACK_IMPORTED_MODULE_6__["a"])(o).then((function(e){})),!0},onConfirm:function(e){if(e[e.length-1]!=JSON.parse(localStorage.getItem("userInfo")).real_name){var t=this.peopleobj[e[e.length-1]];this.form.ChargeUserID=t.uid,this.form.ChargeUserName=t.real_name,this.form.ChargeLinkPhone=t.mobile,this.showPicker2=!1}else this.$toast({message:"不能转派给自己",position:"top"})},back:function(){this.$store.commit("active",0),history.back(-1)}}}},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,a){var o=a("1d80"),r=a("5899"),s="["+r+"]",i=RegExp("^"+s+s+"*"),n=RegExp(s+s+"*$"),_=function(e){return function(t){var a=String(o(t));return 1&e&&(a=a.replace(i,"")),2&e&&(a=a.replace(n,"")),a}};e.exports={start:_(1),end:_(2),trim:_(3)}},"9c4d":function(e,t,a){},a9e3:function(e,t,a){"use strict";var o=a("83ab"),r=a("da84"),s=a("94ca"),i=a("6eeb"),n=a("5135"),_=a("c6b6"),c=a("7156"),l=a("c04e"),u=a("d039"),p=a("7c73"),d=a("241c").f,f=a("06cf").f,m=a("9bf2").f,h=a("58a8").trim,v="Number",C=r[v],O=C.prototype,E=_(p(O))==v,y=function(e){var t,a,o,r,s,i,n,_,c=l(e,!1);if("string"==typeof c&&c.length>2)if(c=h(c),t=c.charCodeAt(0),43===t||45===t){if(a=c.charCodeAt(2),88===a||120===a)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:o=2,r=49;break;case 79:case 111:o=8,r=55;break;default:return+c}for(s=c.slice(2),i=s.length,n=0;n<i;n++)if(_=s.charCodeAt(n),_<48||_>r)return NaN;return parseInt(s,o)}return+c};if(s(v,!C(" 0o1")||!C("0b1")||C("+0x1"))){for(var g,w=function(e){var t=arguments.length<1?0:e,a=this;return a instanceof w&&(E?u((function(){O.valueOf.call(a)})):_(a)!=v)?c(new C(y(t)),a,w):y(t)},b=o?d(C):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),I=0;b.length>I;I++)n(C,g=b[I])&&!n(w,g)&&m(w,g,f(C,g));w.prototype=O,O.constructor=w,i(r,v,w)}},aba8:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("van-row",{staticStyle:{height:"100%"}},[o("van-row",{staticClass:"dt-title",attrs:{type:"flex",align:"center"}},[o("van-col",{attrs:{span:"2"}},[o("van-icon",{staticClass:"dt-back",attrs:{name:"arrow-left"},on:{click:e.back}})],1),o("van-col",{attrs:{span:"20"}},[o("p",{staticClass:"dt-home-shouye"},[e._v("新增工单")])])],1),o("van-row",[o("van-form",[o("van-row",{staticClass:"dt-content"},[o("van-row",{staticClass:"dt-table"},[o("van-row",{staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title",attrs:{span:8}},[e._v("工单编号：")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{staticClass:"dt-input",attrs:{readonly:"",placeholder:"请输入",rules:[{required:!0,message:"请填写工单编号"}]},model:{value:e.form.SecunityCode,callback:function(t){e.$set(e.form,"SecunityCode",t)},expression:"form.SecunityCode"}})],1)],1),o("van-row",{staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title",attrs:{span:8}},[e._v("提交人：")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{attrs:{readonly:"",placeholder:"请输入",rules:[{required:!0,message:"请填"}]},model:{value:e.form.OperatorUserName,callback:function(t){e.$set(e.form,"OperatorUserName",t)},expression:"form.OperatorUserName"}})],1)],1),o("van-row",{staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title dt-time-title",attrs:{span:8}},[e._v("提交时间：")]),o("van-col",{staticClass:"dt-item-content"},[o("span",{staticClass:"dt-time"},[e._v(e._s(e.form.OperationTime.format("yyyy-MM-dd")))])])],1),o("van-row",{staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title",attrs:{span:8}},[o("span",{staticStyle:{color:"red"}},[e._v("* ")]),e._v("选择类型:")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{attrs:{readonly:"",clickable:"",value:e.orderType,placeholder:"选择类型"},on:{click:function(t){e.showPicker=!0}}}),o("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showPicker,callback:function(t){e.showPicker=t},expression:"showPicker"}},[o("van-picker",{attrs:{"show-toolbar":"",columns:e.typeList},on:{cancel:function(t){e.showPicker=!1},confirm:e.gdtype}})],1)],1)],1),o("van-row",{staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title"},[o("span",{staticStyle:{color:"red"}},[e._v("* ")]),e._v("工单内容:")])],1),o("van-row",[o("van-field",{staticClass:"dt-input",staticStyle:{width:"299px","margin-left":"30px"},attrs:{rows:"3",autosize:"",type:"textarea",maxlength:"50",placeholder:"请输入内容","show-word-limit":""},model:{value:e.form.SecunityContent,callback:function(t){e.$set(e.form,"SecunityContent",t)},expression:"form.SecunityContent"}})],1),o("van-row",{directives:[{name:"show",rawName:"v-show",value:e.isStore,expression:"isStore"}],staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title"},[e._v("订单编号:")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{staticClass:"dt-input",attrs:{rows:"1",autosize:"",type:"textarea",placeholder:"请输入内容"},model:{value:e.form.OrderNo,callback:function(t){e.$set(e.form,"OrderNo",t)},expression:"form.OrderNo"}})],1)],1),o("van-row",{directives:[{name:"show",rawName:"v-show",value:e.isStore,expression:"isStore"}],staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title"},[e._v("订单金额:")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{staticClass:"dt-input",attrs:{rows:"1",autosize:"",type:"textarea",placeholder:"请输入内容"},model:{value:e.form.OrderMoney,callback:function(t){e.$set(e.form,"OrderMoney",t)},expression:"form.OrderMoney"}})],1)],1),o("van-row",{directives:[{name:"show",rawName:"v-show",value:e.isStore,expression:"isStore"}],staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title"},[e._v("订单商品:")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{staticClass:"dt-input",attrs:{rows:"1",autosize:"",type:"textarea",placeholder:"请输入内容"},model:{value:e.form.OrderGoods,callback:function(t){e.$set(e.form,"OrderGoods",t)},expression:"form.OrderGoods"}})],1)],1),o("van-row",{directives:[{name:"show",rawName:"v-show",value:e.isStore,expression:"isStore"}],staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title"},[e._v("物流公司:")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{staticClass:"dt-input",attrs:{rows:"1",autosize:"",type:"textarea",placeholder:"请输入内容"},model:{value:e.form.LogisticsCompany,callback:function(t){e.$set(e.form,"LogisticsCompany",t)},expression:"form.LogisticsCompany"}})],1)],1),o("van-row",[o("van-row",{staticClass:"dt-top"},[o("van-col",{staticClass:"dt-item-title-pic",attrs:{span:8}},[e._v("上传图片：")])],1),o("div",{staticClass:"dt-upImg-box",staticStyle:{"text-align":"left"}},[o("van-uploader",{attrs:{"before-read":e.upImgBefore,"after-read":e.upImgAfter,"before-delete":e.deleteImg,"max-count":9,multiple:"","upload-icon":a("ffb7")},model:{value:e.upImgList,callback:function(t){e.upImgList=t},expression:"upImgList"}})],1)],1),o("van-row",{staticClass:"dt-line"},[o("van-col",{staticClass:"dt-item-title",attrs:{span:8}},[o("span",{staticStyle:{color:"red"}},[e._v("* ")]),e._v("指派给：")]),o("van-col",{staticClass:"dt-item-content"},[o("van-field",{attrs:{readonly:"",clickable:"",value:e.form.ChargeUserName,placeholder:"请选择"},on:{click:function(t){e.showPicker2=!0}}}),o("van-popup",{attrs:{round:"",position:"bottom"},model:{value:e.showPicker2,callback:function(t){e.showPicker2=t},expression:"showPicker2"}},[o("van-picker",{attrs:{"show-toolbar":"",columns:e.peoples},on:{confirm:e.onConfirm,cancel:function(t){e.showPicker2=!1}}})],1)],1)],1)],1),o("van-row",[o("van-col",{attrs:{span:12}},[o("van-button",{staticStyle:{width:"100px"},attrs:{round:"",type:"info"},on:{click:e.handleCancel}},[e._v("取消")])],1),o("van-col",{attrs:{span:12}},[o("van-button",{staticStyle:{width:"100px"},attrs:{round:"","native-type":"submit",type:"info"},on:{click:e.addWorkOrder}},[e._v("确定")])],1)],1)],1)],1)],1)],1)},r=[],s=a("256c"),i=s["a"],n=(a("2336"),a("2877")),_=Object(n["a"])(i,o,r,!1,null,"d7430028",null);t["default"]=_.exports},b0c0:function(e,t,a){var o=a("83ab"),r=a("9bf2").f,s=Function.prototype,i=s.toString,n=/^\s*function ([^ (]*)/,_="name";o&&!(_ in s)&&r(s,_,{configurable:!0,get:function(){try{return i.call(this).match(n)[1]}catch(e){return""}}})}}]);
//# sourceMappingURL=chunk-0e968370.c59f0fa8.js.map